<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
    <title>易车 · 老司机周刊</title>
    <link rel="stylesheet" href="../public/css/reset-h5.css">
    <link rel="stylesheet" href="../public/css/animate.css">
    <!-- videojs css-->
    <link rel="stylesheet" href="../public/plugins/videojs/5.8.8/video-js.css" >
    <!-- 预加载插件 -->
    <script type="text/javascript" src="../public/scripts/pace.js"></script>
    <!-- css3免前缀插件 -->
    <script type="text/javascript" src="../public/scripts/prefixfree.min.js"></script>
    <!-- videojs -->
    <script type="text/javascript" src="../public/plugins/videojs/5.8.8/video.min.js"></script>
    <script type="text/javascript" src="../public/scripts/jquery-1.12.1.min.js"></script>
    <style>
        input { width: 300px; line-height: 32px; height: 32px; border: 1px solid black; }
    </style>
</head>
<body ontouchmove="event.preventDefault();">
<input id="record" type="button" value="开始录音"/>
<input id="translate" type="button" value="语音识别"/>
</body>
<script type="text/javascript" src="http://res.wx.qq.com/open/js/jweixin-1.0.0.js"></script>
<script type="text/javascript" src="js/wechat_api.js"></script>
<script>
    var isRecord = false;
    var voiceId = null;
    $('#record').click(function () {
        if (!isRecord) {
            isRecord = true;
            wx.startRecord();
            $('#record').val('正在录音');
        } else {
            isRecord = false
            $('#record').val('开始录音');
            wx.stopRecord({
                success: function (res) {
                    voiceId = res.localId;
                    alert(voiceId);
                },
                error: function () {
                    alert('error');
                }
            });
        }
    });
    $('#translate').click(function(){
        if(voiceId == null){
            alert('请录制一段语音');
            return;
        }
        wx.translateVoice({
            localId: voiceId,
            success: function (res) {
                if(res.hasOwnProperty('translateResult'))
                    alert(res.translateResult); // 语音识别的结果
                else
                    alert('无法识别语音');
            }
        });
    });
</script>
</html>